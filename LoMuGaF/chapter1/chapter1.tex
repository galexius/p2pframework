\chapter{Einleitung}

Spiele auf mobilen Endgeräten gibt es unzählige. Jedoch sind die
meisten dieser Spiele entweder Singleplayer oder sind Serverbasierte Multiplayer
Spiele. Dies bedeutet, dass zum Spielen mit Anderen eine aktive
Internetverbindung vorhanden sein muss. Trotz der mittlerweile gut ausgebauten
Netzabdeckung und guter Internetgeschwindigkeit auf Smartphones, kann das
Spielerlebniss durch den hohen Roundtrip getrübt werden. So sind z.B.
Actionspiele meist nur über eine Hotspot Verbindung spielbar. Außerdem gibt es
Situationen bei denen man keine oder nur eine beschränkte Internetverbindung
hat, z.B. wenn man mit dem Zug unterwegs ist oder sich gerade in Ausland
befindet und sich die Roaminggebühren sparen will. Gerade in solchen Situationen
ist die Möglichkeit miteinander eine Mehrspielerpartie zu starten ohne eine
Internetverbindung zu haben sehr willkommen. Man denke an die Situtation man
sitze im Zug mit paar Freunden und möchte eine Runde Karten spielen, aber man
hat keinen Platz für die richtigen Karten.
Um die Entwicklung solcher Spiele vorran zu treiben und es den Entwicklern
soweit wie möglich zu erleichtern, wollte ich ein Framework dafür zur Verfügung stellen.
Ich wollte die ganzen Kommunikatonsbedingen Herausforderungen mit dem Framework
lösen, sodass die Entwickler sich nur um die Implementierung der Spiele selbst Gedanken
machen müssen. Die Entwickler hätten nur die Aufgabe sich
um die Synchronisierung der spielbezogenen Daten zu kümmern und die
Übertragen der Daten an die einzelnen Gerät würde sozusagen vom Framework übernommen.
Damit die Entwicklung solcher Spiele für die Hobbyentwickler keine finanziellen
Hürden stellt, habe ich mich für das Android SDK entschieden. Da das Android SDK
kostenlos für jeden Entwickler zur Verfügung steht, kann jeder Entwickler, der
über ein Android Gerät verfügt gleich mit der Entwicklung des Spieles loslegen.
Natürlich lässt sich das Framework auch für praktische Anwendungen, wie z.B.
Textmessanger, verwenden, jedoch werden ich im Rahmen dieser Ausarbeitung nur
auf die Realisierung von Spielen eingehen.

\section{Konzepte}

  Das Framework basiert auf dem Peer-to-Peer Prinzip und benötigt deswegen
  keinen weiteren Server. Weil durch einen Serverbasierten Ansatz der Zustand
  des Spiels nur auf dem Server organisiert wird ist es eine
  gewisse Herausforderung bei einem Peer-to-Peer Ansatz alle Gerät synchron zu
  halten. Der Entwickler hat nur Objekte, über die er die Kommunikation realisieren muss. Dabei handelt es sich zum einen um Objekte, die die eingehenden Signale behandeln und zum Anderen Objekte um Nachrichten an die anderen Spieler zu senden.
 
\begin{wrapfigure}{r}{0.5\textwidth}
   \centering
   \includegraphics[width=0.48\textwidth]{chapter1/emitterhandler}
   \caption[Von Text umflossenes Bild]{Kommunications-Konzept}
   \label{fig:Wrap}
\end{wrapfigure}
   
  Jedes der Geräte hat zum einen einen Handler sowie einen Emitter. Der Emitter
  ist das Objekt welches die Signale an andere Geräte rausschickt und der Handler ist somit das Objekt, welches auf jedem Gerät die eingehende Nachricht behandelt. In den meisten Anwendungsfällen haben die Emitter und
  Handler auf allen Geräten die selbe Impelementierung. Zusätzlich wird eine
  Session verwendung um die einzelnen Spielsitzungen oder Spielrunden in sich
  geschlossen zu handhaben. Somit erstellt ein Host eine Session zu der sich die
  die Klienten verbinden können um an der Spielrunde teilnehmen zu können.
  Dadurch wird außerdem die Möglichkeit  gegeben mehrere Spiele simultan im
  selben Netzwerk zu spielen.

\section{Ziel und Aufgabenstellung der Arbeit}

Ziel dieser Arbeit ist es die Lokalisierung und Verbindung der Geräte vom
Framework übernehmen zu lassen. Somit hat der Entwickler sich nur um die
Implementierung der Schnittstellen-Objekte zu kümmern über die die
Kommunikation abläuft. Das Framework soll auf dem Android SDK aufbauen, da es
sich hierbei um eine kostenlos verfügbaren Entwicklungsframework handelt.
Weiterhin sind zwei Spiele als praktische Beispiele mithilfe dieses Frameworks zu 
implementierung um zum einen die Vorgehensweise zu demonstrieren und zum Anderen die 
Realisierbarkeit zu testen.
  
\section{Lösungsweg der Aufgabenstellung}  
  
Um sich die ganzen Herausforderung bei der Realisierung Endgerät-zu-Endgerät
Kommunikation zu ersparen wurde ein weiteres Framework namens
AllJoyn verwendet, welches die die Verbindung und die Kommunikation zum
größten Teil schon übernimmt. Somit blieb zum Einen eine geschickte
Integration von AllJoyn in das Framework, weiterhin mussten die vielen,
gerade auf den ersten Blick komplizierten, Konfigurationen des AllJoyn
Frameworks durch eine einfache Schnittstelle erweitert werden. Außerdem
musste ein Multithreaded Handler-System verwendet werden um UI-Prozesse des
Spiels nicht durch die Hintergrundprozesse der Gerätekommunikation zu
behindern. Als praktische Anwendungsbeispiele wurde ein Echtzeitpuzzlespiel
und ein Turnbased Kartenspiel namens MauMau implementiert.
   
\section{Gliederung}

Die Arbeit beinhaltet zu Anfang die Erklärung der verwendeten Frameworks
AndroidSDK und AllJoyn. Dabei werden die Konzepte dieser Frameworks grob
beschrieben. Als nächstes wird das Konzept und die Impelementierung des
Multiplayer Spieleframeworks, welches das Hauptaugenmerk dieser Arbeit ist,
beschrieben. Daraufhin wird beschrieben wie die zwei Spielebeispiele realisiert
wurden, sowie Herausforderung, die während der Implementierung entstanden.
Zum Schluss gibt es noch eine theoretische Auseinandersetzung mit dem Prinzip
der Wlan basierten P2P-Spiele.
